Procedure ReadUpConfig(a:String);
Var t:xtText;

function gnl:string;
var
  i:longint;
  a:String;
begin;
a:=xtReadLn(t,255);
i:=pos(';',a);
if (i>0) then a:=copy(a,1,i-1);
a:=' '+a+' ';
kicserel('  ',' ',a);
a:=copy(a,2,length(a)-2);
gnl:=a;
end;

function gnw(var b:String):string;
var
  bb:array[0..1] of byte absolute b;
  bb0:byte absolute b;
  a:string;
  ab:array[0..1] of byte absolute a;
  ab0:byte absolute a;
  i:longint;
begin;
ab0:=0;
while (bb0>0) do begin;
  if (bb[1]=32) then break;
  inc(ab0);
  ab[ab0]:=bb[1];
  b:=copy(b,2,666);
  end;
b:=copy(b,2,666);
gnw:=a;
end;

Var
  b:String;
  i:LongInt;
Begin;
WriteLn('reading '+a+'...');
if (xtOpen(t,a,true)<>0) then immErr('error opening!');
authentingPort:=BVal(gnl);
accountingPort:=BVal(gnl);
sharedSecret:=gnl;
logFileName:=gnl;
logFileLock:=(BVal(gnl)<>0);
authenticateCurrentProcess:=gnl;
fillchar(attribs2addr,sizeof(attribs2addr),0);
while not xtEOF(t) do begin;
  a:=gnl;
  if (a='') then continue;
  i:=bval(gnw(a));
  b:=kicsi(gnw(a));
  if (b='txt') then begin;
    putRadiusAttrib(attribs2addr,i,a);
    continue;
    end;
  if (b='bin') then begin;
    b:='';
    while (a<>'') do b:=b+chr(BVal(gnw(a)));
    putRadiusAttrib(attribs2addr,i,b);
    continue;
    end;
  if (b='num') then begin;
    b[0]:=#4;
    WriteLongMSB(b[1],BVal(a));
    putRadiusAttrib(attribs2addr,i,b);
    continue;
    end;
  if (b='ip4') then begin;
    b[0]:=#16;
    string2ipAddr(a,b[1]);
    b:=copy(b,13,666);
    putRadiusAttrib(attribs2addr,i,b);
    continue;
    end;
  if (b='ip6') then begin;
    b[0]:=#16;
    string2ipAddr(a,b[1]);
    putRadiusAttrib(attribs2addr,i,b);
    continue;
    end;
  end;
xtClose(t);
WriteLn('the following attributes will be sent:');
dumpOneRadiusPacket(attribs2addr,false);
End;
